 var mysql=require('mysql');
 
  function connectServer(){
  
      var client=mysql.createConnection({
          host:'10.99.123.32',
          port:'3306',
          user:'root',
          password:'',
          database:'sys'
     })
 
     return client;
 }
 
 
 function  selectFun(client,password,username,callback){
     //client为一个mysql连接对象
     client.query('select * from sys.table_1 where password=password(?) and username =?',[password,username],function(err,results,fields){
         if(err) throw err;
 
         callback(results);
     });
 }
 function  selectlogAll(client,callback){
     //client为一个mysql连接对象
     client.query('SELECT * FROM sys.log',function(err,results){
         if(err) throw err;
 
         callback(err,results);
     });
 }

  function  selectuserAll(client,callback){
     //client为一个mysql连接对象
     client.query('SELECT * FROM sys.table_1',function(err,results){
         if(err) throw err;
 
         callback(err,results);
     });
 }

 function  selectSysAll(client,callback){
     //client为一个mysql连接对象
     client.query('SELECT * FROM sys.table_2',function(err,results){
         if(err) throw err;
 
         callback(err,results);
     });
 }
  function  selectspsys(client,callback){
     //client为一个mysql连接对象
     client.query('SELECT * FROM sys.table_4',function(err,results){
         if(err) throw err;
 
         callback(err,results);
     });
 }

 function  selectMessageAll(client,callback){
     //client为一个mysql连接对象
     client.query('SELECT * FROM sys.table_3',function(err,results){
         if(err) throw err;
 
         callback(err,results);
     });
 }
 //系统类型与ip地址
  function  selectSys(client,systype,callback){
     //client为一个mysql连接对象
     client.query('select ip from sys.table_2 where systype="'+systype+'"',function(err,results,fields){
         if(err) throw err;
 
         callback(results);
     });
 }
 
 function insertFun(client , username , password , powr,callback){
     client.query('insert into sys.table_1(username,password,powr) value(?,password(?),?)', [username, password, powr], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }

 function insertMessage(client,username,name,contect,message,callback){
     client.query('insert into sys.table_3(username,name,contect,message) value(?,?,?,?)', [username,name,contect,message], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }
function insertSys(client,systype,ip,info,callback){
     client.query('insert into sys.table_2(systype,ip,info) value(?,?,?)', [systype,ip,info], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }

 function insertSys2(client,systype,ip,callback){
     client.query('insert into sys.table_2(systype,ip) value(?,?)', [systype,ip], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           //callback(err);
     });
 }

 function insertSpSys(client,spsysname,spip,ranid,callback){
     client.query('insert into sys.table_4(sysname,spip,ranid) value(?,?,?)', [spsysname,spip,ranid], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
          // callback(err);
     });
 }
function insertlog(client,username,callback){
     client.query('insert into sys.log(username) value(?)', [username], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }
 function deleteSys(client,id,callback){
     client.query('DELETE FROM sys.table_2 WHERE id = ?', [id], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }


 function deleteSpSys(client,id,callback){
     client.query('DELETE FROM sys.table_4 WHERE idtable_4 = ?', [id], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }
  function deleteUser(client,id,callback){
     client.query('DELETE FROM sys.table_1 WHERE ids = ?', [id], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }
   function UpUser(client,id,callback){
     client.query('update sys.table_1 set powr="2" where ids=?', [id], function(err,result){
         if( err ){
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
 }

 exports.insertSpSys = insertSpSys;
 exports.deleteSpSys = deleteSpSys;
 exports.selectspsys = selectspsys;
 exports.UpUser = UpUser;
 exports.deleteUser = deleteUser;
 exports.selectuserAll = selectuserAll;
 exports.selectlogAll = selectlogAll;
 exports.insertlog = insertlog;
 exports.selectMessageAll = selectMessageAll;
exports.deleteSys = deleteSys;
 exports.connect = connectServer;
 exports.selectSysAll = selectSysAll;
 exports.selectFun  = selectFun;
 exports.insertFun = insertFun;
 exports.selectSys  = selectSys;
 exports.insertMessage = insertMessage;
  exports.insertSys = insertSys;
  exports.insertSys2 = insertSys2;